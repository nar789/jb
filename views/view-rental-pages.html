<% include base-top.html %>
<% include page-edit-modal.html %>
      <!-- start page title -->
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box">
                                    <a href="/view/rental/pages/my"><h4 class="page-title"><i class="mdi mdi-file"></i> 장부관리</h4></a>
                                </div>
                            </div>
                        </div>
                        <!-- end page title -->

                         <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">

                                        <a href='/view/request/rental'><button class='btn btn-success btn-lg' style="float:right;">대여 / 반납</button></a>
                                        <% if(menu!='all' && menu!='my'){ %>
                                            <button class='btn btn-outline-info mr-2 btn-lg' style="float:right;" onclick='page_edit()'>페이지편집</button>
                                            
                                        <% } %>
                                        <h2 class="mb-3">구글승인팀의 시료장부</h2>



                                        <ul class="nav nav-pills bg-light nav-justified mb-3">
                                            <li class="nav-item">
                                                <a href="/view/rental/pages/all" class="nav-link rounded-0 <% if(menu=='all'){ %>active<% } %>">
                                                    <i class="mdi mdi-home-variant d-lg-none d-block mr-1"></i>
                                                    <span class="d-none d-lg-block">ALL</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="/view/rental/pages/my" class="nav-link rounded-0 <% if(menu=='my'){ %>active<% } %>">
                                                    <i class="mdi mdi-account-circle d-lg-none d-block mr-1"></i>
                                                    <span class="d-none d-lg-block">MY</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="/view/rental/pages/stg" class="nav-link rounded-0 <% if(menu=='stg'){ %>active<% } %>" >
                                                    <i class="mdi mdi-settings-outline d-lg-none d-block mr-1"></i>
                                                    <span class="d-none d-lg-block">전략</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="/view/rental/pages/tablet" class="nav-link rounded-0 <% if(menu=='tablet'){ %>active<% } %>">
                                                    <i class="mdi mdi-settings-outline d-lg-none d-block mr-1"></i>
                                                    <span class="d-none d-lg-block">Tablet</span>
                                                </a>
                                            </li>
                                            <li class="nav-item">
                                                <a href="/view/rental/pages/mass" class="nav-link rounded-0 <% if(menu=='mass'){ %>active<% } %>">
                                                    <i class="mdi mdi-settings-outline d-lg-none d-block mr-1"></i>
                                                    <span class="d-none d-lg-block">MASS</span>
                                                </a>
                                            </li>
                                        </ul>

                                        <div class="tab-content">
                                            <div class="tab-pane active" id="all">
                                                <table id="datatable-buttons" class="table table-striped dt-responsive" style="width:100% !important;">
                                                    <thead>
                                                        <tr>
                                                            <th>번호</th>
                                                            <th>모델명</th>
                                                            <th>사업자</th>
                                                            <th>라벨</th>
                                                            <th>이름</th>
                                                            <th>개수</th>
                                                            <th>상태</th>
                                                            <th>시간</th>
                                                            <th>자세히</th>
                                                        </tr>
                                                    </thead>
                                                
                                                
                                                    <tbody id=tbody>

                                                        <% for(var i=0;i<rows.length;i++) { %>
                                                        <tr>
                                                            <td><%=(i+1)%></td>
                                                            <td><%=rows[i].models%></td>
                                                            <td><%=rows[i].saleses%></td>
                                                            <td><%=rows[i].labels%></td>
                                                            <td ><%=rows[i].name%></td>
                                                            <td ><%=rows[i].cnt%></td>
                                                            <td >
                                                                <% if(rows[i].state=='rental') { %>
                                                                    <b style="color:#fa5c7c;">대여</b>
                                                                <% } else { %>
                                                                    <b style="color:#0acf97;">반납</b>
                                                                <% } %>
                                                            </td>
                                                            <td onclick="javascript:jbalert('시간','<%=rows[i].write_dt%>');"><a href='#'><%=timeAgo.format(rows[i].write_dt)%></a></td>
                                                            <td>
                                                                <a href='/view/rental/detail/<%=rows[i].user_id%>/<%=rows[i].ts%>'><button class='btn btn-primary' >자세히 보기</button></a>
                                                            </td>
                                                        </tr>
                                                        <% } %>
                                                    </tbody>
                                                </table>
                                            </div>
                                            <div class="tab-pane" id="settings1">
                                                <p>Food truck quinoa dolor sit amet, consectetuer adipiscing elit. Aenean commodo ligula eget dolor. Aenean massa. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec quam felis, ultricies nec, pellentesque eu, pretium quis, sem. Nulla consequat massa quis enim.</p>
                                                <p class="mb-0">Donec pede justo, fringilla vel, aliquet nec, vulputate eget, arcu. In enim justo, rhoncus ut, imperdiet a, venenatis vitae, justo. Nullam dictum felis eu pede mollis pretium. Integer tincidunt.Cras dapibus. Vivamus elementum semper nisi. Aenean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim.</p>
                                            </div>
                                        </div>

                                    </div> <!-- end card-body-->
                                </div> <!-- end card-->
                            </div><!-- end col-->
                        </div>
                        <!-- end row-->
<% include base-bottom.html %>
<script>
    var ms;
    function page_edit(){

        $.get('/api/filter/<%=menu%>',(d,s)=>{
            var s=``;
            ms=d.models;
            ms=ms.split(',');
            
                
            var fs=d.filter;
            fs=fs.split(',');
            $('#len').val(ms.length);
            for(var i=0;i<ms.length;i++){
                var e=false;
                for(var j=0;j<fs.length;j++)
                {   
                    if(ms[i]==fs[j])
                    {
                        e=true;
                        s=s+`
                             <div class="custom-control custom-checkbox">
                                <input type="checkbox" class="custom-control-input" id="check${i+1}" checked>
                                <label class="custom-control-label" for="check${i+1}">${ms[i]}</label>
                            </div>
                        `;
                        break;
                    }
                    
                }
                if(!e)
                {
                    s=s+`
                         <div class="custom-control custom-checkbox">
                            <input type="checkbox" class="custom-control-input" id="check${i+1}" name="${ms[i]}">
                            <label class="custom-control-label" for="check${i+1}" id="check${i+1}_label">${ms[i]}</label>
                        </div>
                    `;
                }
            }
            $('#check_body').html(s);
            $('#page-edit-modal').modal('show');
        });

        //$('#page-edit-modal').modal('show');
    }   
    
</script>